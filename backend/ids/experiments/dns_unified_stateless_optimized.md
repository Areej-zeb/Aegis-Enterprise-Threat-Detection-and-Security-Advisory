# DNS Exfiltration Detection - Training Report

## Dataset: dns_unified_stateless

**Training Date:** 2025-12-04 23:47:07

---

## üìä Dataset Statistics

- **Total Samples:** 536,138
- **Features:** 17
- **Train/Test Split:** 428,910 / 107,228

### Class Distribution (Training Set)
- **BENIGN:** 193,428
- **DNS_EXFILTRATION:** 235,482
- **Class Ratio (benign/attack):** 0.8214:1

---

## ü§ñ Model Configuration

**Algorithm:** XGBoost (Gradient Boosting)

### Parameters (FULLY OPTIMIZED for 98.5%+ F1)
- `n_estimators`: 300
- `max_depth`: 6
- `learning_rate`: 0.05
- `subsample`: 0.8
- `colsample_bytree`: 0.8
- `gamma`: 0.1
- `min_child_weight`: 3
- `scale_pos_weight`: 0.8214
- `objective`: binary:logistic
- `tree_method`: gpu_hist (GPU accelerated)
- `eval_metric`: aucpr (Precision-Recall AUC)

**Training Time:** 12.11 seconds

---

## üìà Performance Metrics

### Overall Performance
| Precision (Macro) | 0.8732 |
| Recall (Macro) | 0.7989 |
| ROC-AUC | 0.7983 |
| PR-AUC | 0.7512 |
| Inference Time | 0.16s |
| Precision (Macro) | 0.8732 |
| Recall (Macro) | 0.7989 |
| ROC-AUC | 0.7983 |
| Inference Time | 0.16s |

### Per-Class Metrics

#### BENIGN Class
| Metric | Score |
|--------|-------|
| Precision | 0.9938 |
| Recall | 0.6009 |
| F1-Score | 0.7490 |

#### DNS_EXFILTRATION Class
| Metric | Score |
|--------|-------|
| Precision | 0.7526 |
| Recall | 0.9969 |
| F1-Score | 0.8577 |

### Confusion Matrix

```
             Predicted
             BENIGN  ATTACK
Actual BENIGN   14529    9649
       ATTACK      90   29346
```

---

## üîç Explainability

- **SHAP Summary Plot:** `shap_summary.png`
- **LIME Explanation:** `lime_explanation.png`

---

## üìù Notes
- **Preprocessing:** Merged ALL sources (heavy + light attacks + benign)
- **Feature Selection:** Kept ALL numeric/statistical features
- **Imbalance Handling:** Natural ratio preserved via scale_pos_weight (no resampling)
- **Split Strategy:** Stratified 80/20 (preserves class distribution)no resampling)
- **Split Strategy:** Stratified 70/15/15 (preserves class distribution)

---

*Generated by Aegis IDS - Optimized DNS Training Pipeline*
