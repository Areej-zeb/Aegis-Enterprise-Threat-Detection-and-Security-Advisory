# DNS Exfiltration Detection - Training Report

## Dataset: dns_unified_stateful

**Training Date:** 2025-12-04 23:48:20

---

## üìä Dataset Statistics

- **Total Samples:** 175,107
- **Features:** 33
- **Train/Test Split:** 140,085 / 35,022

### Class Distribution (Training Set)
- **BENIGN:** 73,427
- **DNS_EXFILTRATION:** 66,658
- **Class Ratio (benign/attack):** 1.1015:1

---

## ü§ñ Model Configuration

**Algorithm:** XGBoost (Gradient Boosting)

### Parameters (FULLY OPTIMIZED for 98.5%+ F1)
- `n_estimators`: 300
- `max_depth`: 6
- `learning_rate`: 0.05
- `subsample`: 0.8
- `colsample_bytree`: 0.8
- `gamma`: 0.1
- `min_child_weight`: 3
- `scale_pos_weight`: 1.1015
- `objective`: binary:logistic
- `tree_method`: gpu_hist (GPU accelerated)
- `eval_metric`: aucpr (Precision-Recall AUC)

**Training Time:** 4.28 seconds

---

## üìà Performance Metrics

### Overall Performance
| Precision (Macro) | 0.8678 |
| Recall (Macro) | 0.8466 |
| ROC-AUC | 0.8561 |
| PR-AUC | 0.7650 |
| Inference Time | 0.12s |
| Precision (Macro) | 0.8678 |
| Recall (Macro) | 0.8466 |
| ROC-AUC | 0.8561 |
| Inference Time | 0.12s |

### Per-Class Metrics

#### BENIGN Class
| Metric | Score |
|--------|-------|
| Precision | 0.9820 |
| Recall | 0.7075 |
| F1-Score | 0.8224 |

#### DNS_EXFILTRATION Class
| Metric | Score |
|--------|-------|
| Precision | 0.7536 |
| Recall | 0.9857 |
| F1-Score | 0.8542 |

### Confusion Matrix

```
             Predicted
             BENIGN  ATTACK
Actual BENIGN    6494    2685
       ATTACK     119    8213
```

---

## üîç Explainability

- **SHAP Summary Plot:** `shap_summary.png`
- **LIME Explanation:** `lime_explanation.png`

---

## üìù Notes
- **Preprocessing:** Merged ALL sources (heavy + light attacks + benign)
- **Feature Selection:** Kept ALL numeric/statistical features
- **Imbalance Handling:** Natural ratio preserved via scale_pos_weight (no resampling)
- **Split Strategy:** Stratified 80/20 (preserves class distribution)no resampling)
- **Split Strategy:** Stratified 70/15/15 (preserves class distribution)

---

*Generated by Aegis IDS - Optimized DNS Training Pipeline*
